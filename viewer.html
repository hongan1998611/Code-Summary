<!DOCTYPE html>
<html lang="vi" class="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XMind Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: {
                50: "#f0f9ff",
                100: "#e0f2fe",
                200: "#bae6fd",
                300: "#7dd3fc",
                400: "#38bdf8",
                500: "#0ea5e9",
                600: "#0284c7",
                700: "#0369a1",
                800: "#075985",
                900: "#0c4a6e",
              },
              accent: {
                50: "#ecfdf5",
                100: "#d1fae5",
                200: "#a7f3d0",
                300: "#6ee7b7",
                400: "#34d399",
                500: "#10b981",
                600: "#059669",
                700: "#047857",
                800: "#065f46",
                900: "#064e3b",
              },
              neutral: {
                50: "#f8fafc",
                100: "#f1f5f9",
                200: "#e2e8f0",
                300: "#cbd5e1",
                400: "#94a3b8",
                500: "#64748b",
                600: "#475569",
                700: "#334155",
                800: "#1e293b",
                900: "#0f172a",
              },
            },
            animation: {
              "fade-in": "fadeIn 0.5s ease-in-out",
              "slide-in-right": "slideInRight 0.3s ease-out",
              "scale-in": "scaleIn 0.2s ease-out",
            },
            keyframes: {
              fadeIn: {
                "0%": { opacity: "0" },
                "100%": { opacity: "1" },
              },
              slideInRight: {
                "0%": { transform: "translateX(100%)", opacity: "0" },
                "100%": { transform: "translateX(0)", opacity: "1" },
              },
              scaleIn: {
                "0%": { transform: "scale(0.8)", opacity: "0" },
                "100%": { transform: "scale(1)", opacity: "1" },
              },
            },
          },
        },
      };
    </script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="./static/css/viewer.css" />
  </head>
  <body
    class="min-h-screen bg-gradient-to-br from-gray-50 via-blue-50 to-indigo-100"
  >
    <!-- Header -->
    <header
      class="bg-white/80 backdrop-blur-sm border-b border-neutral-200 sticky top-0 z-40 shadow-sm"
    >
      <div class="max-w-7xl mx-auto px-2 sm:px-3 lg:px-4">
          <div class="flex justify-between items-center h-12 py-2">
            <div class="flex items-center space-x-2">
              <div
                class="h-6 w-6 bg-gradient-to-r from-primary-500 to-accent-500 rounded-lg flex items-center justify-center"
              >
                <i class="fas fa-brain text-white text-xs"></i>
              </div>
              <h1 class="text-base font-bold text-neutral-800">XMind Viewer</h1>
              <div class="hidden sm:block">
                <span id="mindmapTitle" class="text-xs text-neutral-600"
                  >Đang tải...</span
                >
              </div>
            </div>
            <div class="flex items-center space-x-2">
              <!-- Search Box -->
              <div class="relative hidden md:block">
                <input
                  type="text"
                  id="searchBox"
                  placeholder="Tìm kiếm..."
                  class="w-56 px-3 py-1.5 bg-neutral-100 border border-neutral-300 rounded-lg text-neutral-800 placeholder-neutral-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 text-sm"
                />
                <i
                  class="fas fa-search absolute right-3 top-2 text-neutral-400"
                ></i>
              </div>
              <!-- Controls -->
              <button
                id="expandAllBtn"
                class="px-3 py-1.5 bg-accent-500 hover:bg-accent-600 text-white rounded-lg text-sm transition-colors shadow-sm"
                title="Mở rộng tất cả"
              >
                <i class="fas fa-plus-square mr-1"></i>
                <span class="hidden sm:inline">Mở rộng</span>
              </button>
              <button
                id="collapseAllBtn"
                class="px-3 py-1.5 bg-amber-500 hover:bg-amber-600 text-white rounded-lg text-sm transition-colors shadow-sm"
                title="Thu gọn tất cả"
              >
                <i class="fas fa-minus-square mr-1"></i>
                <span class="hidden sm:inline">Thu gọn</span>
              </button>
              <button
                id="logoutBtn"
                class="px-3 py-1.5 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors"
              >
                <i class="fas fa-sign-out-alt mr-2"></i>Đăng xuất
              </button>
            </div>
          </div>
        </div>
      </header>

      <!-- Search Sidebar - Fixed Position -->
      <div
        id="searchSidebar"
        class="fixed left-0 w-0 bg-white shadow-lg transition-all duration-300 overflow-hidden flex-shrink-0 flex flex-col z-30"
        style="top: 60px; height: calc(100vh - 60px);"
      >
        <div class="p-4 border-b flex-shrink-0">
          <div class="flex justify-between items-center">
            <h3 class="font-semibold text-gray-800">Kết quả tìm kiếm</h3>
            <button
              id="closeSidebarBtn"
              class="text-gray-500 hover:text-gray-700"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="mt-2 text-sm text-gray-600">
            <span id="searchResultCount">0 kết quả</span>
          </div>
        </div>
        <div id="searchResults" class="flex-1 overflow-y-auto p-4">
          <!-- Search results will be populated here -->
        </div>
      </div>

      <!-- Content Container -->
      <div class="transition-all duration-300" id="mainContent">
      <main class="flex-1 pt-2">
        <!-- Main Mindmap Area - Full Width -->
        <div class="max-w-full mx-auto px-1 py-1">
          <div id="mindmapContainer" class="space-y-0">
            <!-- Mindmap content will be rendered here -->
          </div>
        </div>
      </main>

      <!-- Error Modal -->
      <div
        id="errorModal"
        class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden"
      >
        <div
          class="bg-white rounded-lg p-6 max-w-md w-full mx-4 border border-neutral-200 shadow-xl"
        >
          <div class="flex items-center mb-4">
            <i
              class="fas fa-exclamation-triangle text-red-500 text-xl mr-3"
            ></i>
            <h3 class="text-lg font-semibold text-neutral-800">
              Lỗi tải dữ liệu
            </h3>
          </div>
          <p id="errorMessage" class="text-neutral-600 mb-4">
            Không thể tải dữ liệu mindmap. Vui lòng kiểm tra kết nối mạng và thử
            lại.
          </p>
          <div class="flex space-x-3">
            <button
              id="retryBtn"
              class="flex-1 bg-primary-500 hover:bg-primary-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              <i class="fas fa-redo mr-2"></i>Thử lại
            </button>
            <button
              id="backToLoginBtn"
              class="flex-1 bg-neutral-500 hover:bg-neutral-600 text-white px-4 py-2 rounded-lg transition-colors"
            >
              <i class="fas fa-arrow-left mr-2"></i>Quay lại
            </button>
          </div>
        </div>
      </div>

      <!-- Notes Modal -->
      <div
        id="notesModal"
        class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden"
      >
        <div
          class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 border border-neutral-200 shadow-2xl"
        >
          <div class="flex items-center justify-between mb-4">
            <h3
              id="notesTitle"
              class="text-xl font-bold text-neutral-800 flex items-center"
            >
              <i class="fas fa-sticky-note text-amber-500 mr-3"></i>
              <span></span>
            </h3>
            <button
              id="closeNotesModal"
              class="text-neutral-400 hover:text-neutral-600 transition-colors"
            >
              <i class="fas fa-times text-xl"></i>
            </button>
          </div>
          <div class="max-h-96 overflow-y-auto">
            <div
              id="notesContent"
              class="text-neutral-700 leading-relaxed whitespace-pre-wrap"
            ></div>
          </div>
          <div class="mt-6 flex justify-end">
            <button
              id="closeNotesBtn"
              class="px-6 py-2 bg-primary-500 hover:bg-primary-600 text-white rounded-lg transition-colors"
            >
              Đóng
            </button>
          </div>
        </div>
      </div>

      <!-- Tooltip -->
      <div
        id="tooltip"
        class="fixed pointer-events-none bg-neutral-800 text-white p-2 rounded-lg shadow-lg border border-neutral-600 text-sm max-w-xs z-40 hidden"
      >
        <div id="tooltipContent"></div>
      </div>

      <!-- Data now loaded from GitHub JSON file -->

    
      </script>

      <!-- Markmap CDN -->
      <script src="https://cdn.jsdelivr.net/npm/markmap-lib/dist/browser/markmap.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/markmap-view/dist/browser/view.min.js"></script>

      <!-- JavaScript -->
      <script src="./static/js/viewer.js"></script>
     
  </body>
</html>
